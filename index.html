<!doctype html>
<html lang="hi" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JanPrahar News - ‡§∏‡§ö ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:ital@0;1&amp;family=Oswald:wght@400;500;600;700&amp;family=Source+Sans+3:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body { box-sizing: border-box; }
    
    :root {
      --primary: #B11226;
      --secondary: #1C1C1C;
      --background: #F7F7F7;
      --accent: #6B7280;
      --alert: #F59E0B;
    }
    
    .dark {
      --primary: #E63946;
      --secondary: #E5E7EB;
      --background: #111827;
      --accent: #9CA3AF;
    }
    
    body {
      font-family: 'Source Sans 3', 'Tiro Devanagari Hindi', sans-serif;
      background-color: var(--background);
      transition: background-color 0.3s, color 0.3s;
    }
    
    .dark body, .dark .bg-main {
      background-color: #111827;
      color: #E5E7EB;
    }
    
    .font-headline {
      font-family: 'Oswald', 'Tiro Devanagari Hindi', sans-serif;
    }
    
    .font-hindi {
      font-family: 'Tiro Devanagari Hindi', serif;
    }
    
    .bg-primary { background-color: var(--primary); }
    .bg-secondary { background-color: var(--secondary); }
    .text-primary { color: var(--primary); }
    .text-secondary { color: var(--secondary); }
    .text-accent { color: var(--accent); }
    .border-primary { border-color: var(--primary); }
    
    .ticker-wrapper {
      overflow: hidden;
      white-space: nowrap;
    }
    
    .ticker-content {
      display: inline-block;
      animation: ticker 30s linear infinite;
    }
    
    @keyframes ticker {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }
    
    .news-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    
    .dark .news-card {
      background-color: #1F2937;
      border-color: #374151;
    }
    
    .dark .bg-white {
      background-color: #1F2937 !important;
    }
    
    .dark input, .dark textarea, .dark select {
      background-color: #374151 !important;
      border-color: #4B5563 !important;
      color: #E5E7EB !important;
    }
    
    .ad-placeholder {
      background: linear-gradient(135deg, #E5E7EB 0%, #D1D5DB 100%);
      border: 2px dashed #9CA3AF;
    }
    
    .dark .ad-placeholder {
      background: linear-gradient(135deg, #374151 0%, #4B5563 100%);
      border-color: #6B7280;
    }

    .modal-overlay {
      background-color: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
    }

    .loading-spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid var(--primary);
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full">
  <div id="app" class="h-full overflow-auto bg-main" style="background-color: var(--background);"><!-- FRONTEND VIEW -->
   <div id="frontend-view"><!-- Top Navigation -->
    <header class="bg-secondary sticky top-0 z-50 shadow-lg" style="background-color: var(--secondary);">
     <div class="max-w-7xl mx-auto px-4">
      <div class="flex items-center justify-between h-16"><!-- Logo -->
       <div class="flex items-center space-x-3">
        <div class="w-10 h-10 bg-primary rounded flex items-center justify-center" style="background-color: var(--primary);">
         <svg class="w-6 h-6 text-white" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
         </svg>
        </div>
        <div>
         <h1 id="site-name" class="font-headline text-white text-xl font-bold tracking-tight">JanPrahar News</h1>
         <p id="site-tagline" class="text-xs text-gray-400 font-hindi">‡§∏‡§ö ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º</p>
        </div>
       </div><!-- Navigation Links -->
       <nav class="hidden md:flex items-center space-x-6"><button onclick="filterCategory('all')" class="text-gray-300 hover:text-white text-sm font-medium transition">‡§π‡•ã‡§Æ</button> <button onclick="filterCategory('politics')" class="text-gray-300 hover:text-white text-sm font-medium transition">‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø</button> <button onclick="filterCategory('business')" class="text-gray-300 hover:text-white text-sm font-medium transition">‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞</button> <button onclick="filterCategory('technology')" class="text-gray-300 hover:text-white text-sm font-medium transition">‡§ü‡•á‡§ï‡•ç‡§®‡•ã‡§≤‡•â‡§ú‡•Ä</button> <button onclick="filterCategory('sports')" class="text-gray-300 hover:text-white text-sm font-medium transition">‡§ñ‡•á‡§≤</button> <button onclick="filterCategory('regional')" class="text-gray-300 hover:text-white text-sm font-medium transition">‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•Ä‡§Ø</button>
       </nav><!-- Right Section -->
       <div class="flex items-center space-x-4"><!-- Search -->
        <div class="relative hidden sm:block"><input type="text" id="search-input" placeholder="‡§ñ‡•ã‡§ú‡•á‡§Ç..." class="w-40 lg:w-56 px-4 py-2 pl-10 bg-gray-800 text-white text-sm rounded-full border border-gray-700 focus:border-primary focus:outline-none" onkeyup="handleSearch(event)">
         <svg class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
         </svg>
        </div><!-- Dark Mode Toggle --> <button onclick="toggleDarkMode()" class="p-2 text-gray-400 hover:text-white transition" title="Dark Mode">
         <svg id="dark-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
         </svg>
         <svg id="light-icon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
         </svg></button> <!-- Admin Login --> <button id="admin-btn" onclick="showAdminLogin()" class="hidden px-4 py-2 bg-primary text-white text-sm font-medium rounded hover:opacity-90 transition" style="background-color: var(--primary);">
  Admin
</button>

       </div>
      </div>
     </div>
    </header><!-- Breaking News Ticker -->
    <div class="bg-primary py-2" style="background-color: var(--primary);">
     <div class="max-w-7xl mx-auto px-4 flex items-center"><span id="breaking-label" class="bg-white text-primary px-3 py-1 text-xs font-bold uppercase tracking-wider mr-4 flex-shrink-0 animate-pulse" style="color: var(--primary);"> ‡§¨‡•ç‡§∞‡•á‡§ï‡§ø‡§Ç‡§ó ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º </span>
      <div class="ticker-wrapper flex-1">
       <div class="ticker-content text-white text-sm font-medium" id="ticker-content">
        ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡•á ‡§π‡•à‡§Ç... ‚Ä¢ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§Ç...
       </div>
      </div>
     </div>
    </div><!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 py-8"><!-- Category Filter Pills -->
     <div class="flex flex-wrap gap-2 mb-8" id="category-pills"><button onclick="filterCategory('all')" class="category-pill active px-4 py-2 rounded-full text-sm font-medium transition bg-primary text-white" data-category="all" style="background-color: var(--primary);"> ‡§∏‡§≠‡•Ä ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ </button> <button onclick="filterCategory('politics')" class="category-pill px-4 py-2 rounded-full text-sm font-medium transition bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300" data-category="politics"> ‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø </button> <button onclick="filterCategory('business')" class="category-pill px-4 py-2 rounded-full text-sm font-medium transition bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300" data-category="business"> ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞ </button> <button onclick="filterCategory('technology')" class="category-pill px-4 py-2 rounded-full text-sm font-medium transition bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300" data-category="technology"> ‡§ü‡•á‡§ï‡•ç‡§®‡•ã‡§≤‡•â‡§ú‡•Ä </button> <button onclick="filterCategory('sports')" class="category-pill px-4 py-2 rounded-full text-sm font-medium transition bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300" data-category="sports"> ‡§ñ‡•á‡§≤ </button> <button onclick="filterCategory('regional')" class="category-pill px-4 py-2 rounded-full text-sm font-medium transition bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300" data-category="regional"> ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•Ä‡§Ø </button>
     </div><!-- Lead Story + Sidebar Layout -->
     <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12"><!-- Lead Story -->
      <div class="lg:col-span-2" id="lead-story-container">
       <div class="bg-white rounded-lg shadow-lg overflow-hidden news-card transition-all duration-300">
        <div class="relative">
         <div class="w-full h-80 bg-gradient-to-br from-gray-300 to-gray-400 flex items-center justify-center">
          <div class="text-center text-gray-600">
           <svg class="w-16 h-16 mx-auto mb-2 opacity-50" fill="currentColor" viewbox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 19V5h14v14H5zm4-4h6v2H9v-2zm0-4h6v2H9v-2z" />
           </svg>
           <p class="font-hindi text-sm">‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§ú‡•ã‡§°‡§º‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è Admin ‡§™‡•à‡§®‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç</p>
          </div>
         </div>
         <div class="absolute top-4 left-4"><span class="bg-primary text-white px-3 py-1 text-xs font-bold uppercase" style="background-color: var(--primary);">‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ñ‡§¨‡§∞</span>
         </div>
        </div>
        <div class="p-6">
         <h2 class="font-headline text-2xl lg:text-3xl font-bold text-secondary mb-3 leading-tight" style="color: var(--secondary);">JanPrahar News ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à</h2>
         <p class="text-accent mb-4 font-hindi" style="color: var(--accent);">‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è Admin ‡§™‡•à‡§®‡§≤ ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§®‡§è ‡§≤‡•á‡§ñ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç‡•§</p>
         <div class="flex items-center text-sm text-accent" style="color: var(--accent);"><span class="font-medium">‡§∏‡§Ç‡§™‡§æ‡§¶‡§ï‡•Ä‡§Ø ‡§ü‡•Ä‡§Æ</span> <span class="mx-2">‚Ä¢</span> <span id="current-date"></span>
         </div>
        </div>
       </div>
      </div><!-- Sidebar -->
      <div class="space-y-6"><!-- Ad Placeholder -->
       <div class="ad-placeholder rounded-lg p-6 text-center h-48 flex items-center justify-center">
        <div>
         <p class="text-gray-500 text-sm font-medium">‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§∏‡•ç‡§•‡§æ‡§®</p>
         <p class="text-gray-400 text-xs mt-1">300 x 250</p>
        </div>
       </div><!-- Trending Section -->
       <div class="bg-white rounded-lg shadow p-5">
        <h3 class="font-headline text-lg font-bold text-secondary border-b-2 border-primary pb-2 mb-4" style="color: var(--secondary); border-color: var(--primary);">üìà ‡§ü‡•ç‡§∞‡•á‡§Ç‡§°‡§ø‡§Ç‡§ó</h3>
        <div id="trending-list" class="space-y-3">
         <p class="text-accent text-sm font-hindi" style="color: var(--accent);">‡§ï‡•ã‡§à ‡§ü‡•ç‡§∞‡•á‡§Ç‡§°‡§ø‡§Ç‡§ó ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç</p>
        </div>
       </div>
      </div>
     </div><!-- News Grid -->
     <section class="mb-12">
      <h2 class="font-headline text-2xl font-bold text-secondary mb-6 border-l-4 border-primary pl-4" style="color: var(--secondary); border-color: var(--primary);">‡§§‡§æ‡§ú‡§º‡§æ ‡§ñ‡§¨‡§∞‡•á‡§Ç</h2>
      <div id="news-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!-- News cards will be dynamically inserted here -->
       <div class="col-span-full text-center py-12">
        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="currentColor" viewbox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 19V5h14v14H5z" />
        </svg>
        <p class="text-accent font-hindi text-lg" style="color: var(--accent);">‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</p>
        <p class="text-gray-400 text-sm mt-2">Admin ‡§™‡•à‡§®‡§≤ ‡§∏‡•á ‡§®‡§è ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</p>
       </div>
      </div>
     </section><!-- Bottom Ad Banner -->
     <div class="ad-placeholder rounded-lg p-8 text-center mb-8">
      <p class="text-gray-500 font-medium">‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§¨‡•à‡§®‡§∞</p>
      <p class="text-gray-400 text-xs mt-1">728 x 90 Leaderboard</p>
     </div>
    </main><!-- Footer -->
    <footer class="bg-secondary text-white py-12" style="background-color: var(--secondary);">
     <div class="max-w-7xl mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8"><!-- Brand -->
       <div class="md:col-span-2">
        <div class="flex items-center space-x-3 mb-4">
         <div class="w-12 h-12 bg-primary rounded flex items-center justify-center" style="background-color: var(--primary);">
          <svg class="w-7 h-7 text-white" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
          </svg>
         </div>
         <div>
          <h3 class="font-headline text-xl font-bold">JanPrahar News</h3>
          <p class="text-gray-400 text-sm font-hindi">‡§∏‡§ö ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º</p>
         </div>
        </div>
        <p class="text-gray-400 text-sm leading-relaxed max-w-md">JanPrahar News ‡§≠‡§æ‡§∞‡§§ ‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§Æ‡§Ç‡§ö ‡§π‡•à ‡§ú‡•ã ‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø, ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞, ‡§ñ‡•á‡§≤ ‡§î‡§∞ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•Ä‡§Ø ‡§ñ‡§¨‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§ï‡•ç‡§∑‡§§‡§æ ‡§∏‡•á ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§</p>
       </div><!-- Quick Links -->
       <div>
        <h4 class="font-headline font-bold mb-4">‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§≤‡§ø‡§Ç‡§ï</h4>
        <ul class="space-y-2 text-gray-400 text-sm">
         <li><a href="#" class="hover:text-white transition">‡§π‡§Æ‡§æ‡§∞‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç</a></li>
         <li><a href="#" class="hover:text-white transition">‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§Ç</a></li>
         <li><a href="#" class="hover:text-white transition">‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® ‡§¶‡•á‡§Ç</a></li>
         <li><a href="#" class="hover:text-white transition">‡§ó‡•ã‡§™‡§®‡•Ä‡§Ø‡§§‡§æ ‡§®‡•Ä‡§§‡§ø</a></li>
        </ul>
       </div><!-- Social Media -->
       <div>
        <h4 class="font-headline font-bold mb-4">‡§∏‡•ã‡§∂‡§≤ ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ</h4>
        <div class="flex space-x-3"><a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-primary transition" style="--tw-bg-opacity: 1;">
          <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 24 24">
           <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
          </svg></a> <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-primary transition">
          <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 24 24">
           <path d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z" />
          </svg></a> <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-primary transition">
          <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 24 24">
           <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
          </svg></a> <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-primary transition">
          <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 24 24">
           <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" />
          </svg></a>
        </div>
       </div>
      </div>
      <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-500 text-sm">
       <p>¬© 2024 JanPrahar News. ‡§∏‡§∞‡•ç‡§µ‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§‡•§</p>
      </div>
     </div>
    </footer>
   </div><!-- ARTICLE VIEW -->
   <div id="article-view" class="hidden">
    <header class="bg-secondary sticky top-0 z-50 shadow-lg" style="background-color: var(--secondary);">
     <div class="max-w-4xl mx-auto px-4">
      <div class="flex items-center justify-between h-16"><button onclick="showFrontend()" class="flex items-center space-x-2 text-white hover:text-primary transition">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg><span class="font-medium">‡§µ‡§æ‡§™‡§∏</span> </button>
       <div class="flex items-center space-x-3">
        <div class="w-8 h-8 bg-primary rounded flex items-center justify-center" style="background-color: var(--primary);">
         <svg class="w-5 h-5 text-white" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
         </svg>
        </div><span class="font-headline text-white font-bold">JanPrahar News</span>
       </div><button onclick="toggleDarkMode()" class="p-2 text-gray-400 hover:text-white transition">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
        </svg></button>
      </div>
     </div>
    </header>
    <article class="max-w-4xl mx-auto px-4 py-8">
     <div id="article-content"><!-- Article content will be dynamically inserted -->
     </div>
    </article>
   </div><!-- ADMIN LOGIN MODAL -->
   <div id="admin-login-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 p-8 relative"><button onclick="hideAdminLogin()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg></button>
     <div class="text-center mb-8">
      <div class="w-16 h-16 bg-primary rounded-full flex items-center justify-center mx-auto mb-4" style="background-color: var(--primary);">
       <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
       </svg>
      </div>
      <h2 class="font-headline text-2xl font-bold text-secondary" style="color: var(--secondary);">Admin Login</h2>
      <p class="text-accent text-sm mt-2" style="color: var(--accent);">JanPrahar News CMS</p>
     </div>
     <form onsubmit="handleAdminLogin(event)" class="space-y-4">
      <div><label for="admin-username" class="block text-sm font-medium text-gray-700 mb-1">Username</label> <input type="text" id="admin-username" value="admin" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
      </div>
      <div><label for="admin-password" class="block text-sm font-medium text-gray-700 mb-1">Password</label> <input type="password" id="admin-password" value="admin123" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
      </div>
      <p class="text-xs text-gray-500 text-center">Demo: admin / admin123</p><button type="submit" class="w-full py-3 bg-primary text-white font-bold rounded-lg hover:opacity-90 transition flex items-center justify-center" style="background-color: var(--primary);"> <span>Login to Dashboard</span> </button>
     </form>
    </div>
   </div><!-- ADMIN DASHBOARD -->
   <div id="admin-dashboard" class="hidden">
    <header class="bg-secondary sticky top-0 z-50 shadow-lg" style="background-color: var(--secondary);">
     <div class="max-w-7xl mx-auto px-4">
      <div class="flex items-center justify-between h-16">
       <div class="flex items-center space-x-3">
        <div class="w-10 h-10 bg-primary rounded flex items-center justify-center" style="background-color: var(--primary);">
         <svg class="w-6 h-6 text-white" fill="currentColor" viewbox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
         </svg>
        </div>
        <div>
         <h1 class="font-headline text-white text-lg font-bold">Admin Dashboard</h1>
         <p class="text-xs text-gray-400">JanPrahar News CMS</p>
        </div>
       </div>
       <div class="flex items-center space-x-4"><button onclick="showFrontend()" class="px-4 py-2 text-gray-300 hover:text-white text-sm font-medium transition flex items-center space-x-2">
         <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
         </svg><span>View Site</span> </button> <button onclick="adminLogout()" class="px-4 py-2 bg-gray-700 text-white text-sm font-medium rounded hover:bg-gray-600 transition"> Logout </button>
       </div>
      </div>
     </div>
    </header>
    <div class="max-w-7xl mx-auto px-4 py-8">
     <div class="grid grid-cols-1 lg:grid-cols-4 gap-8"><!-- Sidebar -->
      <div class="lg:col-span-1">
       <div class="bg-white rounded-lg shadow p-4 sticky top-24">
        <nav class="space-y-2"><button onclick="showAdminSection('articles')" class="admin-nav-btn active w-full text-left px-4 py-3 rounded-lg font-medium transition flex items-center space-x-3 bg-primary text-white" data-section="articles" style="background-color: var(--primary);">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
          </svg><span>Articles</span> </button> <button onclick="showAdminSection('new-article')" class="admin-nav-btn w-full text-left px-4 py-3 rounded-lg font-medium transition flex items-center space-x-3 text-gray-700 hover:bg-gray-100" data-section="new-article">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg><span>New Article</span> </button> <button onclick="showAdminSection('stats')" class="admin-nav-btn w-full text-left px-4 py-3 rounded-lg font-medium transition flex items-center space-x-3 text-gray-700 hover:bg-gray-100" data-section="stats">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg><span>Statistics</span> </button>
        </nav>
       </div>
      </div><!-- Main Content -->
      <div class="lg:col-span-3"><!-- Stats Cards -->
       <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
        <div class="bg-white rounded-lg shadow p-5">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-accent text-sm" style="color: var(--accent);">Total Articles</p>
           <p id="stat-total" class="text-3xl font-bold text-secondary" style="color: var(--secondary);">0</p>
          </div>
          <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
           <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
           </svg>
          </div>
         </div>
        </div>
        <div class="bg-white rounded-lg shadow p-5">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-accent text-sm" style="color: var(--accent);">Published</p>
           <p id="stat-published" class="text-3xl font-bold text-green-600">0</p>
          </div>
          <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
           <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg>
          </div>
         </div>
        </div>
        <div class="bg-white rounded-lg shadow p-5">
         <div class="flex items-center justify-between">
          <div>
           <p class="text-accent text-sm" style="color: var(--accent);">Breaking News</p>
           <p id="stat-breaking" class="text-3xl font-bold text-primary" style="color: var(--primary);">0</p>
          </div>
          <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center">
           <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
           </svg>
          </div>
         </div>
        </div>
       </div><!-- Articles Section -->
       <div id="section-articles" class="admin-section">
        <div class="bg-white rounded-lg shadow">
         <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
          <h2 class="font-headline text-xl font-bold text-secondary" style="color: var(--secondary);">Manage Articles</h2><button onclick="showAdminSection('new-article')" class="px-4 py-2 bg-primary text-white text-sm font-medium rounded hover:opacity-90 transition flex items-center space-x-2" style="background-color: var(--primary);">
           <svg class="w-4 h-4" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
           </svg><span>Add Article</span> </button>
         </div>
         <div id="articles-list" class="divide-y divide-gray-200">
          <div class="px-6 py-12 text-center">
           <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
           </svg>
           <p class="text-gray-500">No articles yet. Create your first article!</p>
          </div>
         </div>
        </div>
       </div><!-- New Article Section -->
       <div id="section-new-article" class="admin-section hidden">
        <div class="bg-white rounded-lg shadow">
         <div class="px-6 py-4 border-b border-gray-200">
          <h2 class="font-headline text-xl font-bold text-secondary" style="color: var(--secondary);">Create New Article</h2>
         </div>
         <form id="article-form" onsubmit="handleArticleSubmit(event)" class="p-6 space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
           <div><label for="article-title" class="block text-sm font-medium text-gray-700 mb-2">Title (English)</label> <input type="text" id="article-title" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Enter article title">
           </div>
           <div><label for="article-title-hindi" class="block text-sm font-medium text-gray-700 mb-2">Title (Hindi)</label> <input type="text" id="article-title-hindi" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent font-hindi" placeholder="‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
           </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
           <div><label for="article-category" class="block text-sm font-medium text-gray-700 mb-2">Category</label> <select id="article-category" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"> <option value="">Select Category</option> <option value="politics">‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø (Politics)</option> <option value="business">‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞ (Business)</option> <option value="technology">‡§ü‡•á‡§ï‡•ç‡§®‡•ã‡§≤‡•â‡§ú‡•Ä (Technology)</option> <option value="sports">‡§ñ‡•á‡§≤ (Sports)</option> <option value="regional">‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•Ä‡§Ø (Regional)</option> </select>
           </div>
           <div><label for="article-author" class="block text-sm font-medium text-gray-700 mb-2">Author</label> <input type="text" id="article-author" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Author name">
           </div>
          </div>
          <div><label for="article-image" class="block text-sm font-medium text-gray-700 mb-2">Image URL (Optional)</label> <input type="url" id="article-image" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="https://example.com/image.jpg">
          </div>
          <div><label for="article-tags" class="block text-sm font-medium text-gray-700 mb-2">Tags (comma separated)</label> <input type="text" id="article-tags" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="‡§≠‡§æ‡§∞‡§§, ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞, ‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø">
          </div>
          <div><label for="article-excerpt" class="block text-sm font-medium text-gray-700 mb-2">Excerpt / Summary</label> <textarea id="article-excerpt" rows="2" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent font-hindi" placeholder="‡§≤‡•á‡§ñ ‡§ï‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§≤‡§ø‡§ñ‡•á‡§Ç..."></textarea>
          </div>
          <div><label for="article-content" class="block text-sm font-medium text-gray-700 mb-2">Full Content</label> <textarea id="article-content" rows="10" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent font-hindi" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§≤‡•á‡§ñ ‡§Ø‡§π‡§æ‡§Å ‡§≤‡§ø‡§ñ‡•á‡§Ç..."></textarea>
          </div>
          <div class="flex flex-wrap gap-6"><label class="flex items-center space-x-3 cursor-pointer"> <input type="checkbox" id="article-breaking" class="w-5 h-5 text-primary rounded focus:ring-primary"> <span class="text-sm font-medium text-gray-700">Mark as Breaking News</span> </label> <label class="flex items-center space-x-3 cursor-pointer"> <input type="checkbox" id="article-published" checked class="w-5 h-5 text-primary rounded focus:ring-primary"> <span class="text-sm font-medium text-gray-700">Publish Immediately</span> </label>
          </div>
          <div class="flex items-center space-x-4 pt-4 border-t border-gray-200"><button type="submit" id="submit-btn" class="px-6 py-3 bg-primary text-white font-bold rounded-lg hover:opacity-90 transition flex items-center space-x-2" style="background-color: var(--primary);"> <span id="submit-text">Publish Article</span>
            <div id="submit-spinner" class="loading-spinner hidden"></div></button> <button type="button" onclick="resetArticleForm()" class="px-6 py-3 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition"> Cancel </button>
          </div>
          <p id="form-message" class="text-sm hidden"></p>
         </form>
        </div>
       </div><!-- Stats Section -->
       <div id="section-stats" class="admin-section hidden">
        <div class="bg-white rounded-lg shadow p-6">
         <h2 class="font-headline text-xl font-bold text-secondary mb-6" style="color: var(--secondary);">Category Statistics</h2>
         <div id="category-stats" class="space-y-4">
          <p class="text-gray-500">No data available yet.</p>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Delete Confirmation Modal -->
   <div id="delete-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 p-8">
     <div class="text-center mb-6">
      <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
       <svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
       </svg>
      </div>
      <h3 class="font-headline text-xl font-bold text-gray-900">Delete Article?</h3>
      <p class="text-gray-600 mt-2">This action cannot be undone. The article will be permanently removed.</p>
     </div>
     <div class="flex space-x-4"><button onclick="hideDeleteModal()" class="flex-1 px-4 py-3 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition"> Cancel </button> <button onclick="confirmDelete()" id="confirm-delete-btn" class="flex-1 px-4 py-3 bg-red-600 text-white font-bold rounded-lg hover:bg-red-700 transition flex items-center justify-center"> <span id="delete-text">Delete</span>
       <div id="delete-spinner" class="loading-spinner hidden ml-2"></div></button>
     </div>
    </div>
   </div><!-- Toast Notification -->
   <div id="toast" class="hidden fixed bottom-6 right-6 z-50 px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3 transition-all transform translate-y-4 opacity-0">
    <svg id="toast-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
    </svg><span id="toast-message" class="font-medium"></span>
   </div>
  </div>
  <script>
    // Global State
    let allArticles = [];
    let currentFilter = 'all';
    let searchQuery = '';
    let editingArticle = null;
    let articleToDelete = null;
    let isAdminLoggedIn = false;
    let currentRecordCount = 0;

    // Default Config
    const defaultConfig = {
      site_name: 'JanPrahar News',
      tagline: '‡§∏‡§ö ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º',
      breaking_label: '‡§¨‡•ç‡§∞‡•á‡§ï‡§ø‡§Ç‡§ó ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º',
      primary_color: '#B11226',
      secondary_color: '#1C1C1C',
      background_color: '#F7F7F7',
      text_color: '#6B7280',
      accent_color: '#F59E0B'
    };

    // Data Handler
    const dataHandler = {
      onDataChanged(data) {
        allArticles = data || [];
        currentRecordCount = allArticles.length;
        renderFrontend();
        renderAdminArticles();
        updateStats();
        updateTicker();
      }
    };

    // Initialize SDKs
    async function init() {
      // Set current date
      document.getElementById('current-date').textContent = new Date().toLocaleDateString('hi-IN', {
        day: 'numeric',
        month: 'long',
        year: 'numeric'
      });

      // Initialize Element SDK
      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange: applyConfig,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (v) => { config.primary_color = v; window.elementSdk.setConfig({ primary_color: v }); }
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (v) => { config.secondary_color = v; window.elementSdk.setConfig({ secondary_color: v }); }
              },
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (v) => { config.background_color = v; window.elementSdk.setConfig({ background_color: v }); }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (v) => { config.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (v) => { config.accent_color = v; window.elementSdk.setConfig({ accent_color: v }); }
              }
            ],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
          }),
          mapToEditPanelValues: (config) => new Map([
            ['site_name', config.site_name || defaultConfig.site_name],
            ['tagline', config.tagline || defaultConfig.tagline],
            ['breaking_label', config.breaking_label || defaultConfig.breaking_label]
          ])
        });
      }

      // Initialize Data SDK
      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) {
          showToast('Failed to initialize data', 'error');
        }
      }

      applyConfig(window.elementSdk?.config || defaultConfig);
    }

    // Apply Config
    function applyConfig(config) {
      const cfg = { ...defaultConfig, ...config };
      
      document.getElementById('site-name').textContent = cfg.site_name;
      document.getElementById('site-tagline').textContent = cfg.tagline;
      document.getElementById('breaking-label').textContent = cfg.breaking_label;
      
      document.documentElement.style.setProperty('--primary', cfg.primary_color);
      document.documentElement.style.setProperty('--secondary', cfg.secondary_color);
      document.documentElement.style.setProperty('--background', cfg.background_color);
      document.documentElement.style.setProperty('--accent', cfg.text_color);
      document.documentElement.style.setProperty('--alert', cfg.accent_color);
    }

    // Category Labels
    const categoryLabels = {
      politics: '‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø',
      business: '‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞',
      technology: '‡§ü‡•á‡§ï‡•ç‡§®‡•ã‡§≤‡•â‡§ú‡•Ä',
      sports: '‡§ñ‡•á‡§≤',
      regional: '‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡•Ä‡§Ø'
    };

    // Render Frontend
    function renderFrontend() {
      const published = allArticles.filter(a => a.is_published);
      let filtered = published;

      if (currentFilter !== 'all') {
        filtered = filtered.filter(a => a.category === currentFilter);
      }

      if (searchQuery) {
        const query = searchQuery.toLowerCase();
        filtered = filtered.filter(a => 
          (a.title && a.title.toLowerCase().includes(query)) ||
          (a.title_hindi && a.title_hindi.toLowerCase().includes(query)) ||
          (a.excerpt && a.excerpt.toLowerCase().includes(query))
        );
      }

      // Update Lead Story
      const leadContainer = document.getElementById('lead-story-container');
      if (filtered.length > 0) {
        const lead = filtered[0];
        leadContainer.innerHTML = `
          <div class="bg-white rounded-lg shadow-lg overflow-hidden news-card transition-all duration-300 cursor-pointer" onclick="viewArticle('${lead.__backendId}')">
            <div class="relative">
              ${lead.image_url ? 
                `<img src="${lead.image_url}" alt="${lead.title_hindi}" class="w-full h-80 object-cover" loading="lazy" onerror="this.style.background='linear-gradient(135deg, #E5E7EB 0%, #D1D5DB 100%)'; this.alt='Image unavailable';">` :
                `<div class="w-full h-80 bg-gradient-to-br from-gray-300 to-gray-400 flex items-center justify-center">
                  <svg class="w-16 h-16 text-gray-500 opacity-50" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 19V5h14v14H5zm4-4h6v2H9v-2zm0-4h6v2H9v-2z"/>
                  </svg>
                </div>`
              }
              <div class="absolute top-4 left-4 flex flex-wrap gap-2">
                <span class="bg-primary text-white px-3 py-1 text-xs font-bold uppercase" style="background-color: var(--primary);">${categoryLabels[lead.category] || lead.category}</span>
                ${lead.is_breaking ? `<span class="bg-amber-500 text-white px-3 py-1 text-xs font-bold uppercase animate-pulse">LIVE</span>` : ''}
              </div>
            </div>
            <div class="p-6">
              <h2 class="font-headline text-2xl lg:text-3xl font-bold text-secondary mb-3 leading-tight hover:text-primary transition" style="color: var(--secondary);">
                ${lead.title_hindi || lead.title}
              </h2>
              <p class="text-accent mb-4 font-hindi line-clamp-2" style="color: var(--accent);">
                ${lead.excerpt}
              </p>
              <div class="flex items-center text-sm text-accent" style="color: var(--accent);">
                <span class="font-medium">${lead.author}</span>
                <span class="mx-2">‚Ä¢</span>
                <span>${formatDate(lead.created_at)}</span>
              </div>
            </div>
          </div>
        `;
      } else {
        leadContainer.innerHTML = `
          <div class="bg-white rounded-lg shadow-lg overflow-hidden news-card transition-all duration-300">
            <div class="relative">
              <div class="w-full h-80 bg-gradient-to-br from-gray-300 to-gray-400 flex items-center justify-center">
                <div class="text-center text-gray-600">
                  <svg class="w-16 h-16 mx-auto mb-2 opacity-50" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 19V5h14v14H5zm4-4h6v2H9v-2zm0-4h6v2H9v-2z"/>
                  </svg>
                  <p class="font-hindi text-sm">‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§ú‡•ã‡§°‡§º‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è Admin ‡§™‡•à‡§®‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç</p>
                </div>
              </div>
              <div class="absolute top-4 left-4">
                <span class="bg-primary text-white px-3 py-1 text-xs font-bold uppercase" style="background-color: var(--primary);">‡§Æ   ‡§ñ‡•ç‡§Ø ‡§ñ‡§¨‡§∞</span>
              </div>
            </div>
            <div class="p-6">
              <h2 class="font-headline text-2xl lg:text-3xl font-bold text-secondary mb-3 leading-tight" style="color: var(--secondary);">
                ${currentFilter !== 'all' ? `${categoryLabels[currentFilter]} ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§ñ‡§¨‡§∞ ‡§®‡§π‡•Ä‡§Ç` : 'JanPrahar News ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à'}
              </h2>
              <p class="text-accent mb-4 font-hindi" style="color: var(--accent);">
                ${searchQuery ? `"${searchQuery}" ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ` : '‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è Admin ‡§™‡•à‡§®‡§≤ ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç‡•§'}
              </p>
            </div>
          </div>
        `;
      }

      // Update News Grid
      const newsGrid = document.getElementById('news-grid');
      const otherArticles = filtered.slice(1);
      
      if (otherArticles.length > 0) {
        newsGrid.innerHTML = otherArticles.map(article => `
          <article class="bg-white rounded-lg shadow overflow-hidden news-card transition-all duration-300 cursor-pointer" onclick="viewArticle('${article.__backendId}')">
            <div class="relative">
              ${article.image_url ?
                `<img src="${article.image_url}" alt="${article.title_hindi}" class="w-full h-48 object-cover" loading="lazy" onerror="this.style.background='linear-gradient(135deg, #E5E7EB 0%, #D1D5DB 100%)'; this.alt='Image unavailable';">` :
                `<div class="w-full h-48 bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center">
                  <svg class="w-10 h-10 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
                  </svg>
                </div>`
              }
              <span class="absolute top-3 left-3 bg-primary text-white px-2 py-1 text-xs font-bold" style="background-color: var(--primary);">
                ${categoryLabels[article.category] || article.category}
              </span>
              ${article.is_breaking ? `<span class="absolute top-3 right-3 bg-amber-500 text-white px-2 py-1 text-xs font-bold animate-pulse">LIVE</span>` : ''}
            </div>
            <div class="p-4">
              <h3 class="font-headline text-lg font-bold text-secondary mb-2 line-clamp-2 hover:text-primary transition" style="color: var(--secondary);">
                ${article.title_hindi || article.title}
              </h3>
              <p class="text-accent text-sm mb-3 line-clamp-2 font-hindi" style="color: var(--accent);">
                ${article.excerpt}
              </p>
              <div class="flex items-center text-xs text-accent" style="color: var(--accent);">
                <span>${article.author}</span>
                <span class="mx-2">‚Ä¢</span>
                <span>${formatDate(article.created_at)}</span>
              </div>
            </div>
          </article>
        `).join('');
      } else if (filtered.length === 0) {
        newsGrid.innerHTML = `
          <div class="col-span-full text-center py-12">
            <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 19V5h14v14H5z"/>
            </svg>
            <p class="text-accent font-hindi text-lg" style="color: var(--accent);">
              ${searchQuery ? `"${searchQuery}" ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç` : '‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à   ‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§â‡§™‡§≤‡§¨‡•ç   ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à'}
            </p>
            <p class="text-gray-400 text-sm mt-2">Admin ‡§™‡•à‡§®‡§≤ ‡§∏‡•á ‡§®‡§è ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</p>
          </div>
        `;
      } else {
        newsGrid.innerHTML = '';
      }

      // Update Trending
      updateTrending(published);
    }

    // Update Ticker
    function updateTicker() {
      const breaking = allArticles.filter(a => a.is_published && a.is_breaking);
      const tickerContent = document.getElementById('ticker-content');
      
      if (breaking.length > 0) {
        const tickerText = breaking.map(a => a.title_hindi || a.title).join(' ‚Ä¢ ');
        tickerContent.textContent = tickerText + ' ‚Ä¢ ' + tickerText;
      } else {
        const published = allArticles.filter(a => a.is_published).slice(0, 5);
        if (published.length > 0) {
          const tickerText = published.map(a => a.title_hindi || a.title).join(' ‚Ä¢ ');
          tickerContent.textContent = tickerText + ' ‚Ä¢ ' + tickerText;
        } else {
          tickerContent.textContent = 'JanPrahar News - ‡§∏‡§ö ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º ‚Ä¢ ‡§§‡§æ‡§ú‡§º‡§æ ‡§ñ‡§¨‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡•á ‡§∞‡§π‡•á‡§Ç ‚Ä¢ JanPrahar News - ‡§∏‡§ö ‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º ‚Ä¢ ‡§§‡§æ‡§ú‡§º‡§æ ‡§ñ‡§¨‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡•á ‡§∞‡§π‡•á‡§Ç';
        }
      }
    }

    // Update Trending Section
    function updateTrending(articles) {
      const trendingList = document.getElementById('trending-list');
      const trending = articles.slice(0, 5);
      
      if (trending.length > 0) {
        trendingList.innerHTML = trending.map((a, i) => `
          <div class="flex items-start space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded transition" onclick="viewArticle('${a.__backendId}')">
            <span class="text-primary font-headline font-bold text-lg" style="color: var(--primary);">${i + 1}</span>
            <div>
              <p class="text-sm font-medium text-secondary line-clamp-2" style="color: var(--secondary);">${a.title_hindi || a.title}</p>
              <span class="text-xs text-accent" style="color: var(--accent);">${formatDate(a.created_at)}</span>
            </div>
          </div>
        `).join('');
      } else {
        trendingList.innerHTML = '<p class="text-accent text-sm font-hindi" style="color: var(--accent);">‡§ï‡•ã‡§à ‡§ü‡•ç‡§∞‡•á‡§Ç‡§°‡§ø‡§Ç‡§ó ‡§∏‡§Æ‡§æ‡§ö‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç</p>';
      }
    }

    // Filter Category
    function filterCategory(category) {
      currentFilter = category;
      
      document.querySelectorAll('.category-pill').forEach(pill => {
        if (pill.dataset.category === category) {
          pill.classList.add('text-white');
          pill.style.backgroundColor = 'var(--primary)';
          pill.classList.remove('bg-gray-200', 'text-gray-700');
        } else {
          pill.classList.remove('text-white');
          pill.style.backgroundColor = '';
          pill.classList.add('bg-gray-200', 'text-gray-700');
        }
      });
      
      renderFrontend();
    }

    // Search Handler
    function handleSearch(event) {
      searchQuery = event.target.value;
      if (event.key === 'Enter' || searchQuery === '') {
        renderFrontend();
      }
    }

    // View Article
    function viewArticle(id) {
      const article = allArticles.find(a => a.__backendId === id);
      if (!article) return;

      document.getElementById('frontend-view').classList.add('hidden');
      document.getElementById('article-view').classList.remove('hidden');

      const content = document.getElementById('article-content');
      content.innerHTML = `
        <div class="mb-6">
          <span class="bg-primary text-white px-3 py-1 text-xs font-bold uppercase" style="background-color: var(--primary);">
            ${categoryLabels[article.category] || article.category}
          </span>
          ${article.is_breaking ? '<span class="ml-2 bg-amber-500 text-white px-3 py-1 text-xs font-bold">BREAKING</span>' : ''}
        </div>
        
        <h1 class="font-headline text-3xl lg:text-4xl font-bold text-secondary mb-4 leading-tight" style="color: var(--secondary);">
          ${article.title_hindi || article.title}
        </h1>
        
        <div class="flex flex-wrap items-center gap-4 text-accent mb-6 pb-6 border-b border-gray-200" style="color: var(--accent);">
          <div class="flex items-center space-x-2">
            <div class="w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center">
              <svg class="w-5 h-5 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
            </div>
            <span class="font-medium">${article.author}</span>
          </div>
          <span>‚Ä¢</span>
          <span>${formatDate(article.created_at)}</span>
        </div>
        
        ${article.image_url ? `
          <img src="${article.image_url}" alt="${article.title_hindi}" class="w-full h-auto rounded-lg mb-8" loading="lazy" onerror="this.style.display='none';">
        ` : ''}
        
        <div class="prose prose-lg max-w-none font-hindi">
          <p class="text-lg text-accent mb-6 font-medium italic border-l-4 border-primary pl-4" style="color: var(--accent); border-color: var(--primary);">
            ${article.excerpt}
          </p>
          <div class="text-secondary leading-relaxed whitespace-pre-wrap" style="color: var(--secondary);">
            ${article.content}
          </div>
        </div>
        
        ${article.tags ? `
          <div class="mt-8 pt-6 border-t border-gray-200">
            <h4 class="text-sm font-bold text-accent mb-3" style="color: var(--accent);">Tags:</h4>
            <div class="flex flex-wrap gap-2">
              ${article.tags.split(',').map(tag => `
                <span class="px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-full">${tag.trim()}</span>
              `).join('')}
            </div>
          </div>
        ` : ''}
      `;
    }

    // Show Frontend
    function showFrontend() {
      document.getElementById('frontend-view').classList.remove('hidden');
      document.getElementById('article-view').classList.add('hidden');
      document.getElementById('admin-dashboard').classList.add('hidden');
    }

    // Dark Mode
    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
      const darkIcon = document.getElementById('dark-icon');
      const lightIcon = document.getElementById('light-icon');
      
      if (document.documentElement.classList.contains('dark')) {
        darkIcon.classList.add('hidden');
        lightIcon.classList.remove('hidden');
      } else {
        darkIcon.classList.remove('hidden');
        lightIcon.classList.add('hidden');
      }
    }

    // Admin Functions
    function showAdminLogin() {
      document.getElementById('admin-login-modal').classList.remove('hidden');
    }

    function hideAdminLogin() {
      document.getElementById('admin-login-modal').classList.add('hidden');
    }

    function handleAdminLogin(event) {
      event.preventDefault();
      const username = document.getElementById('admin-username').value;
      const password = document.getElementById('admin-password').value;
      
      if (username === 'admin' && password === 'admin123') {
        isAdminLoggedIn = true;
        hideAdminLogin();
        document.getElementById('frontend-view').classList.add('hidden');
        document.getElementById('admin-dashboard').classList.remove('hidden');
        showToast('Login successful!', 'success');
      } else {
        showToast('Invalid credentials', 'error');
      }
    }

    function adminLogout() {
      isAdminLoggedIn = false;
      showFrontend();
      showToast('Logged out successfully', 'success');
    }

    function showAdminSection(section) {
      document.querySelectorAll('.admin-section').forEach(s => s.classList.add('hidden'));
      document.getElementById(`section-${section}`).classList.remove('hidden');
      
      document.querySelectorAll('.admin-nav-btn').forEach(btn => {
        if (btn.dataset.section === section) {
          btn.classList.add('text-white');
          btn.style.backgroundColor = 'var(--primary)';
          btn.classList.remove('text-gray-700', 'hover:bg-gray-100');
        } else {
          btn.classList.remove('text-white');
          btn.style.backgroundColor = '';
          btn.classList.add('text-gray-700', 'hover:bg-gray-100');
        }
      });

      if (section === 'stats') {
        renderCategoryStats();
      }
    }

    // Render Admin Articles
    function renderAdminArticles() {
      const list = document.getElementById('articles-list');
      
      if (allArticles.length === 0) {
        list.innerHTML = `
          <div class="px-6 py-12 text-center">
            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/>
            </svg>
            <p class="text-gray-500">No articles yet. Create your first article!</p>
          </div>
        `;
        return;
      }

      list.innerHTML = allArticles.map(article => `
        <div class="px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition">
          <div class="flex-1 min-w-0 mr-4">
            <div class="flex items-center space-x-2 mb-1">
              <span class="text-xs font-bold px-2 py-0.5 rounded ${article.is_published ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}">
                ${article.is_published ? 'Published' : 'Draft'}
              </span>
              ${article.is_breaking ? '<span class="text-xs font-bold px-2 py-0.5 rounded bg-amber-100 text-amber-800">Breaking</span>' : ''}
              <span class="text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-800">${categoryLabels[article.category] || article.category}</span>
            </div>
            <h3 class="font-medium text-secondary truncate" style="color: var(--secondary);">${article.title_hindi || article.title}</h3>
            <p class="text-sm text-accent" style="color: var(--accent);">${article.author} ‚Ä¢ ${formatDate(article.created_at)}</p>
          </div>
          <div class="flex items-center space-x-2">
            <button onclick="editArticle('${article.__backendId}')" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition" title="Edit">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
              </svg>
            </button>
            <button onclick="togglePublish('${article.__backendId}')" class="p-2 ${article.is_published ? 'text-orange-600 hover:bg-orange-50' : 'text-green-600 hover:bg-green-50'} rounded-lg transition" title="${article.is_published ? 'Unpublish' : 'Publish'}">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                ${article.is_published ? 
                  '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/>' :
                  '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>'
                }
              </svg>
            </button>
            <button onclick="showDeleteModal('${article.__backendId}')" class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition" title="Delete">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
              </svg>
            </button>
          </div>
        </div>
      `).join('');
    }

    // Update Stats
    function updateStats() {
      document.getElementById('stat-total').textContent = allArticles.length;
      document.getElementById('stat-published').textContent = allArticles.filter(a => a.is_published).length;
      document.getElementById('stat-breaking').textContent = allArticles.filter(a => a.is_breaking).length;
    }

    // Render Category Stats
    function renderCategoryStats() {
      const stats = {};
      allArticles.forEach(a => {
        stats[a.category] = (stats[a.category] || 0) + 1;
      });

      const container = document.getElementById('category-stats');
      if (Object.keys(stats).length === 0) {
        container.innerHTML = '<p class="text-gray-500">No data available yet.</p>';
        return;
      }

      const total = allArticles.length;
      container.innerHTML = Object.entries(stats).map(([cat, count]) => `
        <div class="flex items-center justify-between">
          <span class="font-medium text-secondary" style="color: var(--secondary);">${categoryLabels[cat] || cat}</span>
          <div class="flex items-center space-x-3">
            <div class="w-32 h-2 bg-gray-200 rounded-full overflow-hidden">
              <div class="h-full bg-primary rounded-full" style="width: ${(count/total)*100}%; background-color: var(--primary);"></div>
            </div>
            <span class="text-accent text-sm w-8" style="color: var(--accent);">${count}</span>
          </div>
        </div>
      `).join('');
    }

    // Article Form Handling
    async function handleArticleSubmit(event) {
      event.preventDefault();

      if (currentRecordCount >= 999 && !editingArticle) {
        showToast('Maximum limit of 999 articles reached. Please delete some articles first.', 'error');
        return;
      }

      const submitBtn = document.getElementById('submit-btn');
      const submitText = document.getElementById('submit-text');
      const submitSpinner = document.getElementById('submit-spinner');

      submitBtn.disabled = true;
      submitText.textContent = editingArticle ? 'Updating...' : 'Publishing...';
      submitSpinner.classList.remove('hidden');

      const articleData = {
        title: document.getElementById('article-title').value,
        title_hindi: document.getElementById('article-title-hindi').value,
        category: document.getElementById('article-category').value,
        author: document.getElementById('article-author').value,
        image_url: document.getElementById('article-image').value || '',
        tags: document.getElementById('article-tags').value || '',
        excerpt: document.getElementById('article-excerpt').value,
        content: document.getElementById('article-content').value,
        is_breaking: document.getElementById('article-breaking').checked,
        is_published: document.getElementById('article-published').checked,
        updated_at: new Date().toISOString()
      };

      let result;
      if (editingArticle) {
        const updated = { ...editingArticle, ...articleData };
        result = await window.dataSdk.update(updated);
      } else {
        articleData.created_at = new Date().toISOString();
        result = await window.dataSdk.create(articleData);
      }

      submitBtn.disabled = false;
      submitText.textContent = 'Publish Article';
      submitSpinner.classList.add('hidden');

      if (result.isOk) {
        showToast(editingArticle ? 'Article updated successfully!' : 'Article published successfully!', 'success');
        resetArticleForm();
        showAdminSection('articles');
      } else {
        showToast('Failed to save article. Please try again.', 'error');
      }
    }

    function editArticle(id) {
      const article = allArticles.find(a => a.__backendId === id);
      if (!article) return;

      editingArticle = article;
      
      document.getElementById('article-title').value = article.title || '';
      document.getElementById('article-title-hindi').value = article.title_hindi || '';
      document.getElementById('article-category').value = article.category || '';
      document.getElementById('article-author').value = article.author || '';
      document.getElementById('article-image').value = article.image_url || '';
      document.getElementById('article-tags').value = article.tags || '';
      document.getElementById('article-excerpt').value = article.excerpt || '';
      document.getElementById('article-content').value = article.content || '';
      document.getElementById('article-breaking').checked = article.is_breaking || false;
      document.getElementById('article-published').checked = article.is_published || false;

      document.getElementById('submit-text').textContent = 'Update Article';
      showAdminSection('new-article');
    }

    function resetArticleForm() {
      editingArticle = null;
      document.getElementById('article-form').reset();
      document.getElementById('article-published').checked = true;
      document.getElementById('submit-text').textContent = 'Publish Article';
    }

    // Toggle Publish
    async function togglePublish(id) {
      const article = allArticles.find(a => a.__backendId === id);
      if (!article) return;

      const updated = { ...article, is_published: !article.is_published, updated_at: new Date().toISOString() };
      const result = await window.dataSdk.update(updated);

      if (result.isOk) {
        showToast(updated.is_published ? 'Article published!' : 'Article unpublished', 'success');
      } else {
        showToast('Failed to update article', 'error');
      }
    }

    // Delete Functions
    function showDeleteModal(id) {
      articleToDelete = id;
      document.getElementById('delete-modal').classList.remove('hidden');
    }

    function hideDeleteModal() {
      articleToDelete = null;
      document.getElementById('delete-modal').classList.add('hidden');
    }

    async function confirmDelete() {
      if (!articleToDelete) return;

      const article = allArticles.find(a => a.__backendId === articleToDelete);
      if (!article) return;

      const deleteBtn = document.getElementById('confirm-delete-btn');
      const deleteText = document.getElementById('delete-text');
      const deleteSpinner = document.getElementById('delete-spinner');

      deleteBtn.disabled = true;
      deleteText.textContent = 'Deleting...';
      deleteSpinner.classList.remove('hidden');

      const result = await window.dataSdk.delete(article);

      deleteBtn.disabled = false;
      deleteText.textContent = 'Delete';
      deleteSpinner.classList.add('hidden');

      if (result.isOk) {
        hideDeleteModal();
        showToast('Article deleted successfully', 'success');
      } else {
        showToast('Failed to delete article', 'error');
      }
    }

    // Toast Notification
    function showToast(message, type = 'success') {
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toast-message');
      const toastIcon = document.getElementById('toast-icon');

      toastMessage.textContent = message;
      
      if (type === 'success') {
        toast.className = 'fixed bottom-6 right-6 z-50 px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3 bg-green-600 text-white transition-all transform';
        toastIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
      } else {
        toast.className = 'fixed bottom-6 right-6 z-50 px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3 bg-red-600 text-white transition-all transform';
        toastIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
      }

      toast.classList.remove('hidden', 'translate-y-4', 'opacity-0');
      
      setTimeout(() => {
        toast.classList.add('translate-y-4', 'opacity-0');
        setTimeout(() => toast.classList.add('hidden'), 300);
      }, 3000);
    }

    // Format Date
    function formatDate(dateString) {
      if (!dateString) return '';
      const date = new Date(dateString);
      return date.toLocaleDateString('hi-IN', {
        day: 'numeric',
        month: 'short',
        year: 'numeric'
      });
    }

    // Initialize on load
    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c6806b550e6b2d6',t:'MTc2OTg1MDEwNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script> 
<script>
  (function () {
    const params = new URLSearchParams(window.location.search);
    const adminKey = params.get("admin");

    const SECRET_KEY = "janprahar4125"; // you can change this

    if (adminKey === SECRET_KEY) {
      const adminBtn = document.getElementById("admin-btn");
      if (adminBtn) {
        adminBtn.classList.remove("hidden");
      }
    }
  })();
</script>
</body>
</html>